<!--

    This file is part of huborcid.

    huborcid is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    huborcid is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with huborcid.  If not, see <http://www.gnu.org/licenses/>.

-->
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>popstate event test</title>
</head>
<body>

<script>

(function() {
	var test_id;
	
	function showResult(r) {
		if(test_id && window.parent.setResult) {
			parent.setResult(test_id, r);
		} else {
			alert(r);
		}
	}
	
	if(location.hash.length) {
		test_id = location.hash.substr(1);
	}
	
	if(history.pushState) {
		var rand = Math.random();
		setTimeout(function() {
			history.pushState({foo: 'bar'}, "title", './' + rand);
			var result = (location.href.indexOf(rand) > -1);
			showResult(result);
		}, 100);
	} 
	
})();

</script>

</body>
</html>
